<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sorteo o Donaci√≥n a Campa√±a de Farith Castro al Senado</title>

<style>
body {font-family: Arial, sans-serif; margin:0; background:#f5f7fa;}

header {
  padding:15px;
  background:#f57c00;
  color:white;
  text-align:center;
}

.controls {padding:10px; background:white; position:sticky; top:0; z-index:2;}
button {padding:6px 10px; margin:3px; border:none; border-radius:6px; cursor:pointer;}

.grid {
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(45px,1fr));
  gap:5px;
  padding:10px;
}

.cell {
  padding:10px 0;
  text-align:center;
  border-radius:8px;
  font-weight:bold;
  transition:.2s;
  user-select:none;
}

.available {background:#ffffff; border:1px solid #ccc; cursor:pointer;}
.reserved {background:#ffd54f;}
.sold {background:#ef5350; color:white;}

.stats {margin-top:8px; font-size:14px;}
.admin-indicator {color:green; font-weight:bold;}
</style>
</head>

<body>

<header>
  <h2>üéüÔ∏è SORTEO / DONACI√ìN A CAMPA√ëA DE FARITH CASTRO AL SENADO</h2>
</header>

<div class="controls">
  <button onclick="activateAdmin()">üîí Modo Administrador</button>
  <span id="adminStatus"></span><br><br>
  <button onclick="verCompradores()">Ver Compradores</button>
  <div class="stats">
    Disponibles: <span id="avail">0</span> |
    Reservados: <span id="res">0</span> |
    Vendidos: <span id="sold">0</span>
  </div>
</div>

<div class="grid" id="grid"></div>

<script>
const PASSWORD = "Changel2020";
let isAdmin = false;
const grid = document.getElementById("grid");
let data = JSON.parse(localStorage.getItem("rifaData")) || {};

function save(){
  localStorage.setItem("rifaData", JSON.stringify(data));
  updateStats();
}

function activateAdmin(){
  const pass = prompt("Contrase√±a admin:");
  if(pass===PASSWORD){
    isAdmin=true;
    adminStatus.textContent="MODO ADMIN ACTIVO";
    adminStatus.className="admin-indicator";
  } else alert("Incorrecta");
}

function createBoard(){
  for(let i=0;i<=999;i++){
    const num = i.toString().padStart(3,'0');
    const cell=document.createElement("div");
    cell.textContent=num;
    cell.className="cell";
    cell.dataset.num=num;
    setState(cell, data[num]?.state || "available");
    cell.onclick=()=>toggle(cell);
    grid.appendChild(cell);
  }
  updateStats();
}

function setState(cell,state){
  cell.classList.remove("available","reserved","sold");
  cell.classList.add(state);
}

function toggle(cell){
  let num = cell.dataset.num;
  let record = data[num] || { state: "available" };

  // üë§ Usuario normal reserva
  if(!isAdmin){
    if(record.state!=="available"){
      alert("N√∫mero ocupado");
      return;
    }

    const nombre = prompt("Tu nombre:");
    if(!nombre) return;

    const telefono = prompt("Tu tel√©fono:");
    if(!telefono) return;

    data[num] = { state:"reserved", nombre, telefono };
    setState(cell,"reserved");
    save();
    alert("N√∫mero reservado. Espera confirmaci√≥n del administrador.");
    return;
  }

  // üëë Admin gestiona
  if(record.state==="reserved"){
    if(confirm(`Confirmar venta a ${record.nombre}?`)){
      record.state="sold";
      data[num]=record;
    }
  }
  else if(record.state==="sold"){
    if(confirm("¬øVolver a disponible?")){
      data[num]={ state:"available" };
    }
  }
  else{
    const nombre=prompt("Nombre:");
    if(!nombre) return;
    const telefono=prompt("Tel√©fono:");
    if(!telefono) return;
    data[num]={ state:"reserved", nombre, telefono };
  }

  setState(cell,data[num].state);
  save();
}

function updateStats(){
  let a=0,r=0,s=0;
  for(let i=0;i<=999;i++){
    let key=i.toString().padStart(3,'0');
    let st=data[key]?.state||"available";
    if(st==="available")a++;
    if(st==="reserved")r++;
    if(st==="sold")s++;
  }
  avail.textContent=a;
  res.textContent=r;
  sold.textContent=s;
}

function verCompradores(){
  if(!isAdmin) return alert("Solo admin");
  let lista="";
  for(let n in data){
    let r=data[n];
    if(r.state!=="available"){
      lista+=`${n} - ${r.nombre} - ${r.telefono} - ${r.state}\n`;
    }
  }
  alert(lista||"Sin registros");
}

createBoard();
</script>
</body>
</html>
</html>


