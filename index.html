<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SORTEO O DONACI√ìN A CAMPA√ëA DE FARITH CASTRO AL SENADO</title>

<style>
body{font-family:Arial;margin:0;background:#f5f7fa}
header{padding:15px;background:#f57c00;color:#fff;text-align:center}
.controls{padding:10px;background:#fff;position:sticky;top:0;z-index:2}
input{padding:6px;margin:3px}
button{padding:6px 10px;margin:3px;border:none;border-radius:6px;cursor:pointer}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(50px,1fr));gap:5px;padding:10px}
.cell{padding:10px 0;text-align:center;border-radius:8px;font-weight:bold;cursor:pointer}
.available{background:#fff;border:1px solid #ccc}
.reserved{background:#ffd54f}
.sold{background:#ef5350;color:#fff}
</style>
</head>

<body>

<header>
<h2>üéüÔ∏è SORTEO O DONACI√ìN A CAMPA√ëA DE FARITH CASTRO AL SENADO</h2>
</header>

<div class="controls">
<input type="text" id="nombre" placeholder="Tu nombre">
<input type="text" id="telefono" placeholder="Tu tel√©fono">
<button onclick="guardarReserva()">Guardar reserva</button>

<button onclick="activarAdmin()">üîí Admin</button>
<span id="adminPanel" style="display:none;">
<button onclick="cambiarEstado('sold')">‚úÖ Vendido</button>
<button onclick="cambiarEstado('available')">‚ôª Liberar</button>
</span>

<div>
Disponibles: <span id="avail">0</span> |
Reservados: <span id="res">0</span> |
Vendidos: <span id="sold">0</span>
</div>
</div>

<div class="grid" id="grid"></div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
apiKey: "AIzaSyDwmYt51VgHXOnleHm402ggVdRyXU5xBHI",
authDomain: "sorteo-farith.firebaseapp.com",
databaseURL: "https://sorteo-farith-default-rtdb.firebaseio.com",
projectId: "sorteo-farith"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let seleccionado=null;
let isAdmin=false;
let cache={};

function activarAdmin(){
let pass=prompt("Clave admin:");
if(pass==="Changel2020"){
isAdmin=true;
document.getElementById("adminPanel").style.display="inline";
alert("Modo admin activado");
}
}

const grid=document.getElementById("grid");

for(let i=0;i<1000;i++){
let num=i.toString().padStart(3,"0");
let cell=document.createElement("div");
cell.className="cell available";
cell.textContent=num;
cell.dataset.num=num;
cell.onclick=()=>seleccionar(cell);
grid.appendChild(cell);
}

function seleccionar(cell){
document.querySelectorAll(".cell").forEach(c=>c.style.outline="none");
cell.style.outline="3px solid black";
seleccionado=cell.dataset.num;
}

function guardarReserva(){
if(!seleccionado) return alert("Selecciona n√∫mero");
let nombre=document.getElementById("nombre").value;
let telefono=document.getElementById("telefono").value;
if(!nombre||!telefono) return alert("Faltan datos");

db.ref("rifa/"+seleccionado).set({
nombre,telefono,state:"reserved"
});
}

function cambiarEstado(nuevoEstado){
if(!isAdmin) return;
if(!seleccionado) return alert("Selecciona n√∫mero");

let actual=cache[seleccionado]||{};
db.ref("rifa/"+seleccionado).set({
nombre:actual.nombre||"",
telefono:actual.telefono||"",
state:nuevoEstado
});
}

db.ref("rifa").on("value",snap=>{
cache=snap.val()||{};
let a=0,r=0,s=0;

document.querySelectorAll(".cell").forEach(c=>{
let n=c.dataset.num;
let info=cache[n]||{state:"available"};
c.className="cell "+info.state;

if(info.state==="available") a++;
if(info.state==="reserved") r++;
if(info.state==="sold") s++;
});

avail.textContent=a;
res.textContent=r;
sold.textContent=s;
});
</script>

</body>
</html>






