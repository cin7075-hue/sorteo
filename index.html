<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sorteo o Donaci√≥n a Campa√±a de Farith Castro al Senado</title>
<style>
body {font-family: Arial, sans-serif; margin:0; background:#f5f7fa;}
header {
  padding:15px;
  background:#f57c00; /* naranja */
  color:white; /* letras blancas */
  text-align:center;
}
.controls {padding:10px; background:white; position:sticky; top:0; z-index:2;}
input {padding:6px; width:120px;}
button {padding:6px 10px; margin:3px; border:none; border-radius:6px; cursor:pointer;}
.grid {display:grid;grid-template-columns: repeat(auto-fill, minmax(45px,1fr));gap:5px;padding:10px;}
.cell {padding:10px 0;text-align:center;border-radius:8px;font-weight:bold;user-select:none;transition:.2s;}
.available {background:#ffffff; border:1px solid #ccc; cursor:not-allowed;}
.reserved {background:#ffd54f;}
.sold {background:#ef5350; color:white;}
.admin .cell.available,
.admin .cell.reserved {cursor:pointer;}
.cell:hover {transform:scale(1.05);}
.stats {margin-top:8px; font-size:14px;}
.admin-indicator {color:green; font-weight:bold; margin-left:10px;}
</style>
</head>
<body>

<header>
  <h2>üéüÔ∏è SORTEO / DONACI√ìN A CAMPA√ëA DE FARITH CASTRO AL SENADO</h2>
</header>

<div class="controls">
  <button onclick="activateAdmin()">üîí Modo Administrador</button>
  <span id="adminStatus"></span><br><br>
  Buscar n√∫mero: <input type="number" id="search" min="1" max="1000">
  <button onclick="exportSold()">Exportar Vendidos</button>
  <div class="stats">
    Disponibles: <span id="avail">0</span> |
    Reservados: <span id="res">0</span> |
    Vendidos: <span id="sold">0</span>
  </div>
</div>

<div class="grid" id="grid"></div>

<script>
const PASSWORD = "Changel2020";
let isAdmin = false;
const grid = document.getElementById("grid");
let data = JSON.parse(localStorage.getItem("rifaData")) || {};

function save(){localStorage.setItem("rifaData", JSON.stringify(data));updateStats();}

function activateAdmin(){
  const pass = prompt("Introduce contrase√±a:");
  if(pass===PASSWORD){
    isAdmin=true;
    document.body.classList.add("admin");
    adminStatus.textContent="MODO ADMIN ACTIVO";
    adminStatus.className="admin-indicator";
  } else alert("Contrase√±a incorrecta");
}

function createBoard(){
  for(let i=0;i<=999;i++){
  const cell=document.createElement("div");
  // convertir n√∫mero a 3 d√≠gitos
  const numero = i.toString().padStart(3, '0');
  cell.textContent = numero;
  cell.className="cell";
  cell.dataset.num = numero;
  setState(cell, data[numero] || "available");
  cell.onclick = ()=>{ if(isAdmin) toggle(cell); }
  grid.appendChild(cell);
}
  updateStats();
}

function setState(cell,state){
  cell.classList.remove("available","reserved","sold");
  cell.classList.add(state);
}

function toggle(cell){
  let num = cell.dataset.num;
  let state = data[num] || "available";

  // Ciclo completo para admin
  if(state === "available") state = "reserved";
  else if(state === "reserved") state = "sold";
  else state = "available"; // si estaba vendido vuelve a libre

  data[num] = state;
  setState(cell, state);
  save();}

function updateStats(){
  let a=0,r=0,s=0;
  for(let i=1;i<=1000;i++){
    let st=data[i]||"available";
    if(st==="available")a++;
    if(st==="reserved")r++;
    if(st==="sold")s++;
  }
  avail.textContent=a;res.textContent=r;sold.textContent=s;
}

function exportSold(){
  let soldNums=Object.keys(data).filter(n=>data[n]==="sold");
  alert("Vendidos:\n"+soldNums.join(", "));
}

search.oninput=()=>{
  let val=search.value;
  document.querySelectorAll(".cell").forEach(c=>{
    c.style.outline=c.dataset.num==val?"3px solid blue":"none";
  });
};

createBoard();
</script>
</body>

</html>

